This is a anonymous open source repository for paper "A Large Scale Empirical Analysis on the Adherence Gap between Standards and Tools in SBOM".
The generated SBOMs are at Zenodo: [https://zenodo.org/records/15553839](https://zenodo.org/records/15553839).

## Introduction

A Software Bill of Materials (SBOM) is a machine-readable artifact that systematically organizes software information, enhancing supply chain transparency and security.
To facilitate the exchange and utilization of SBOMs, organizations such as the Linux Foundation and OWASP have proposed SBOM standards.
Following these standards, organizations have developed tools for generating and utilizing SBOMs.
However, limited research has examined the adherence of these SBOM tools to standard specifications, a gap that could lead to compliance failures and disruptions in SBOM utilization.

This paper investigates the adherence gap between SBOM standards and tools using our automated evaluation framework, SAP.
The evaluation covers 26,186 SBOMs generated by six leading SBOM tools from 3,287 real-world repositories.
Our analysis reveals fundamental limitations in current SBOM tools: (1) inadequate adherence to standard specifications;(2) tool inconsistencies, including inter-tool consistency rates as low as 11.7\% to 14\% for package detection across languages and discrepancies when SBOM tools generate SBOMs across different standards; and (3) poor accuracy for detailed software information, e.g., accuracy of package licenses below 20\%.
These gaps indicate the potential unreliability of current SBOM tools in meeting transparency and security requirements. 

![图片](https://github.com/user-attachments/assets/56c59133-6a37-445e-b018-d330d428a677)


## Dataset

We release all the 27,795 generated SBOMs by the six tools at Zenodo: [https://zenodo.org/records/15553839](https://zenodo.org/records/15553839).
The Zenodo link also includes fast check code and related test SBOMs.

## Usage

All the results in paper are in the `results` folder. 

### Docker image for generating SBOMs yourself
We upload the replication docker image that contains all the installed environments of the SBOM tools anonymously at [https://hub.docker.com/r/d32s3a/anonymous-opensource](https://hub.docker.com/r/d32s3a/anonymous-opensource), you can get it by the following command:

```bash
docker pull d32s3a/anonymous-opensource:1.0
```

Use `conda env list` to see all the environments of SBOM tools. The `ort` is at `/all-sbom-tools/ort-35.0.0/ort/cli/build/install/ort/bin/ort`(name with 35.0.0 but it is 36.0.0 as described in paper). The other tools can run directly with its name in their corresponding conda envs. 
All the scripts in SAP for SBOM generation locate at `run-sbom-tools` folder. These scripts need to run in the docker except `cdxgen` that need to interact with docker thus runs on host.

## Run the code

### For fast check on test SBOMs

We provide a small dataset in the test-sboms folder for you to test the code. Download the `run-on-test-sboms.zip` at [https://zenodo.org/records/15553839](https://zenodo.org/records/15553839), and unzip it, then follow the instruction.

We provide a all-in-one script to run the code for evaluating the adherence gap of SBOM tools and SBOM standards. You can run the following command to run the code on the test-sboms dataset:

```bash
pip install -r requirements.txt
python test-run.py
```

As the test sboms are just 42 randomly selected repositories from Python part of the $D_{repo}$, the results are different from our paper but still can check our code. If you want to run the code on all the SBOMs, see next part.

### Run on all SBOMs
If you want to rerun the whole process of SAP on all SBOMs, download and unzip the all-sboms.zip(around 50GB after unzip) at [https://zenodo.org/records/15553839](https://zenodo.org/records/15553839), and change the `dir` in test-run.py and rerun again(possible clean up of the result dir is needed).

The results of the `test-run.py` will be in the `test-sbom-results` folder.


## More details
The results in paper are as follows:

![图片](https://github.com/user-attachments/assets/0292f9a5-1e9f-4908-871e-73bcd61e13b5)


Compliance - C/C++

| tool      | name    | supplier | purl    | license | version | copyrightText | dependency relationship |
| --------- | ------- | -------- | ------- | ------- | ------- | ------------- | ----------------------- |
| syft      | 100.00% | 2.28%    | 48.19%  | 0.99%   | 48.95%  | 0.00%         | 100.00%                 |
| gh-sbom   | 100.00% | 0.00%    | 100.00% | 31.21%  | 100.00% | 7.93%         | 100.00%                 |
| ort       | 100.00% | 0.00%    | 5.48%   | 4.87%   | 80.07%  | 93.97%        | 8.10%                   |
| sbom-tool | 100.00% | 82.47%   | 99.97%  | 11.49%  | 99.97%  | 0.00%         | 100.00%                 |
| scancode* | 46.28%  | 9.89%    | 46.28%  | 46.28%  | 14.33%  | 1.02%         | 100.00%                 |
| cdxgen*   | 65.94%  | 1.44%    | 65.95%  | 2.64%   | 65.95%  | 0.00%         | 100.00%                 |


Compliance - Java

| tool      | name    | supplier | purl    | license | version | copyrightText | dependency relationship |
| --------- | ------- | -------- | ------- | ------- | ------- | ------------- | ----------------------- |
| syft      | 100.00% | 1.76%    | 65.74%  | 3.08%   | 65.80%  | 0.00%         | 100.00%                 |
| gh-sbom   | 100.00% | 0.00%    | 100.00% | 39.65%  | 100.00% | 9.10%         | 100.00%                 |
| ort       | 100.00% | 0.00%    | 14.88%  | 15.02%  | 25.41%  | 77.29%        | 16.59%                  |
| sbom-tool | 100.00% | 93.27%   | 100.00% | 5.43%   | 100.00% | 0.00%         | 100.00%                 |
| scancode* | 33.06%  | 2.94%    | 33.06%  | 33.06%  | 31.54%  | 0.01%         | 100.00%                 |
| cdxgen*   | 90.87%  | 0.03%    | 90.87%  | 18.76%  | 90.87%  | 0.00%         | 100.00%                 |



Compliance - Python

| tool      | name    | supplier | purl   | license  | version | copyrightText | dependency relationship |
| --------- | ------- | -------- | ------ | -------- | ------- | ------------- | ----------------------- |
| syft      | 100.00% | 1.62%    | 42.64% | 0.95%    | 42.78%  | 0.00%         | 100.00%                 |
| gh-sbom   | 100.00% | 0.00%    | 67.87% | 23.15%   | 100.00% | 0.00%         | 100.00%                 |
| ort       | 100.00% | 0.00%    | 21.42% | 22.91%   | 67.49%  | 82.13%        | 24.40%                  |
| sbom-tool | 100.00% | 62.06%   | 99.96% | 30.05%   | 99.96%  | 0.00%         | 100.00%                 |
| scancode* | 50.86%  | 39.24%   | 50.86% | 50.86% | 31.40%  | 0.38%         | 100.00%                 |
| cdxgen*   | 74.60%  | 23.18%   | 74.60% | 27.54%   | 74.60%  | 0.00%         | 100.00%                 |



Consistency - C/C++

| tools             | pkgs  | version | purl  | license |
| ----------------- | ----- | ------- | ----- | ------- |
| syft+gh-sbom      | 8.2%  | 18.4%   | 16.9% | 0.1%    |
| syft+ort          | 1.2%  | 3.1%    | 1.9%  | 0.0%    |
| syft+scancode     | 0.5%  | 4.4%    | 5.0%  | 0.8%    |
| syft+cdxgen       | 10.7% | 28.1%   | 13.3% | 0.1%    |
| gh-sbom+ort       | 4.9%  | 8.7%    | 7.5%  | 1.9%    |
| gh-sbom+scancode  | 0.2%  | 3.1%    | 2.9%  | 0.3%    |
| gh-sbom+cdxgen    | 43.9% | 67.3%   | 39.6% | 1.7%    |
| ort+scancode      | 0.1%  | 0.4%    | 0.2%  | 0.3%    |
| ort+cdxgen        | 3.0%  | 5.8%    | 4.4%  | 0.3%    |
| scancode+cdxgen   | 1.0%  | 4.2%    | 7.6%  | 0.7%    |
| syft+gh-sbom      | 24.4% | 40.5%   | 19.7% | 0.0%    |
| syft+ort          | 0.6%  | 2.8%    | 2.6%  | 0.0%    |
| syft+sbom-tool    | 6.2%  | 12.4%   | 10.7% | 0.0%    |
| gh-sbom+ort       | 0.8%  | 2.7%    | 4.1%  | 0.0%    |
| gh-sbom+sbom-tool | 7.3%  | 11.2%   | 11.6% | 7.7%    |
| ort+sbom-tool     | 74.4% | 5.3%    | 5.3%  | 0.0%    |
| average           | 11.7% | 13.6%   | 9.6%  | 0.9%    |



Consistency - Java

| tools             | pkgs  | version | purl  | license |
| ----------------- | ----- | ------- | ----- | ------- |
| syft+gh-sbom      | 34.6% | 56.3%   | 62.2% | 0.3%    |
| syft+ort          | 5.2%  | 12.9%   | 12.7% | 0.2%    |
| syft+scancode     | 1.3%  | 16.1%   | 14.4% | 0.6%    |
| syft+cdxgen       | 58.4% | 82.3%   | 20.7% | 0.3%    |
| gh-sbom+ort       | 20.3% | 48.1%   | 46.9% | 26.5%   |
| gh-sbom+scancode  | 2.8%  | 26.7%   | 24.3% | 0.7%    |
| gh-sbom+cdxgen    | 35.8% | 74.8%   | 27.7% | 24.0%   |
| ort+scancode      | 0.0%  | 0.7%    | 0.3%  | 0.2%    |
| ort+cdxgen        | 11.2% | 14.3%   | 3.3%  | 6.1%    |
| scancode+cdxgen   | 1.6%  | 15.1%   | 4.6%  | 4.0%    |
| syft+gh-sbom      | 6.1%  | 16.1%   | 8.8%  | 0.0%    |
| syft+ort          | 2.1%  | 12.9%   | 12.7% | 0.0%    |
| syft+sbom-tool    | 3.2%  | 5.5%    | 5.0%  | 0.0%    |
| gh-sbom+ort       | 0.2%  | 0.6%    | 0.8%  | 0.0%    |
| gh-sbom+sbom-tool | 3.0%  | 4.9%    | 4.9%  | 4.0%    |
| ort+sbom-tool     | 9.8%  | 1.0%    | 1.0%  | 0.0%    |
| average           | 12.2% | 24.3%   | 15.6% | 4.2%    |



Consistency - Python

| tools             | pkgs   | version | purl  | license |
| ----------------- | ------ | ------- | ----- | ------- |
| syft+gh-sbom      | 21.8%  | 42.4%   | 41.9% | 0.1%    |
| syft+ort          | 2.8%   | 6.4%    | 4.2%  | 0.0%    |
| syft+scancode     | 0.6%   | 2.4%    | 2.7%  | 1.1%    |
| syft+cdxgen       | 15.1%  | 34.5%   | 31.8% | 0.2%    |
| gh-sbom+ort       | 18.8%  | 15.5%   | 18.8% | 3.8%    |
| gh-sbom+scancode  | 0.2%   | 1.1%    | 2.2%  | 0.3%    |
| gh-sbom+cdxgen    | 47.4%  | 52.0%   | 55.6% | 7.6%    |
| ort+scancode      | 0.0%   | 0.1%    | 0.2%  | 0.1%    |
| ort+cdxgen        | 14.9%  | 24.2%   | 21.3% | 3.1%    |
| scancode+cdxgen   | 4.0%   | 2.8%    | 14.5% | 0.6%    |
| syft+gh-sbom      | 22.9%  | 44.1%   | 33.2% | 0.0%    |
| syft+ort          | 1.0%   | 6.1%    | 5.8%  | 0.0%    |
| syft+sbom-tool    | 8.3%   | 21.5%   | 20.5% | 0.0%    |
| gh-sbom+ort       | 4.0%   | 4.0%    | 4.0%  | 0.0%    |
| gh-sbom+sbom-tool | 15.6%  | 16.4%   | 15.3% | 14.0%   |
| ort+sbom-tool     | 47.1%  | 13.8%   | 12.3% | 0.0%    |
| average           | 14.0%  | 17.9%   | 17.8% | 1.9%    |



Accuracy - Python

| tools     | count | precision | recall | author | version | license |
| --------- | ----- | --------- | ------ | ------ | ------- | ------- |
| syft      | 100   | 17.7%     | 12.4%  | 0.0%   | 18.0%   | 0.0%    |
| gh-sbom   | 36    | 71.3%     | 55.1%  | 0.0%   | 66.6%   | 9.8%    |
| ort       | 84    | 12.0%     | 16.9%  | 0.0%   | 6.0%    | 14.0%   |
| scancode  | -     | -         | -      | -      | -       | -       |
| cdxgen    | 98    | 29.5%     | 42.5%  | 18.4%  | 15.5%   | 14.9%   |
| sbom-tool | 100   | 14.0%     | 23.6%  | 9.7%   | 10.8%   | 18.6%   |
